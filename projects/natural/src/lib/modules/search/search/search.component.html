<div class="natural-search" [ngClass]="{mobile: isMobile | async, hasMultipleGroups: innerSelections.length > 1}">
    <div class="groupsWrapper">
        @for (groupSelections of innerSelections; track groupSelections) {
            <div class="groupWrapper">
                <natural-group
                    (selectionChange)="updateGroup($event, $index)"
                    [facets]="facets"
                    [placeholder]="placeholder"
                    [selections]="groupSelections"
                    [dropdownTitle]="dropdownTitle"
                />
                <div class="endOfRowButton">
                    @if (innerSelections.length > 1) {
                        <button
                            (click)="removeGroup($index)"
                            mat-icon-button
                            i18n-matTooltip
                            matTooltip="Supprimer ce groupe"
                        >
                            <mat-icon naturalIcon="remove" />
                        </button>
                    }
                </div>
            </div>
            @if (!$last) {
                <mat-divider />
            }
        }
    </div>

    <div class="endOfRowButton">
        @if (multipleGroups) {
            <button (click)="addGroup()" mat-icon-button i18n-matTooltip matTooltip="Ajouter un groupe">
                <mat-icon naturalIcon="add" />
            </button>
        }

        <button
            (click)="clear()"
            mat-icon-button
            class="clear-button"
            i18n-matTooltip
            matTooltip="Annuler la recherche"
        >
            <mat-icon naturalIcon="close" />
        </button>
    </div>
</div>
