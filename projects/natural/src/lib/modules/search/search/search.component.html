<div class="natural-search" [ngClass]="{mobile: isMobile | async, hasMultipleGroups: innerSelections.length > 1}">
    <div class="groupsWrapper">
        @for (groupSelections of innerSelections; track groupSelections; let i = $index; let last = $last) {
            <div class="groupWrapper">
                <natural-group
                    (selectionChange)="updateGroup($event, i)"
                    [facets]="facets"
                    [placeholder]="placeholder"
                    [selections]="groupSelections"
                    [dropdownTitle]="dropdownTitle"
                ></natural-group>
                <div class="endOfRowButton">
                    @if (innerSelections.length > 1) {
                        <button
                            (click)="removeGroup(i)"
                            mat-icon-button
                            i18n-matTooltip
                            matTooltip="Supprimer ce groupe"
                        >
                            <mat-icon naturalIcon="remove"></mat-icon>
                        </button>
                    }
                </div>
            </div>
            @if (!last) {
                <mat-divider></mat-divider>
            }
        }
    </div>

    <div class="endOfRowButton">
        @if (multipleGroups) {
            <button (click)="addGroup()" mat-icon-button i18n-matTooltip matTooltip="Ajouter un groupe">
                <mat-icon naturalIcon="add"></mat-icon>
            </button>
        }

        <button
            (click)="clear()"
            mat-icon-button
            class="clear-button"
            i18n-matTooltip
            matTooltip="Annuler la recherche"
        >
            <mat-icon naturalIcon="close"></mat-icon>
        </button>
    </div>
</div>
