<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<!-- Because directives can't be applied conditionally (routerLink, mat-button and mat-icon-button), we have to use different elements -->
@let theIcon = icon();

<!-- Edge case of a button without any kind of link at all -->
@if (type() === 'none') {
    <span>
        @if (theIcon) {
            <mat-icon [naturalIcon]="theIcon" />
        }
        @if (label()) {
            <span>{{ label() }}</span>
        }
    </span>
} @else {
    @switch (type()) {
        <!-- App routed link -->
        @case ('routerLink') {
            @if (label()) {
                <a
                    [matButton]="appearance()"
                    [color]="color()"
                    [queryParams]="queryParams()"
                    [queryParamsHandling]="queryParamsHandling()"
                    [routerLink]="navigate()"
                    [fragment]="fragment()"
                    [preserveFragment]="preserveFragment()"
                    [disabled]="disabled()"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                    <span>{{ label() }}</span>
                </a>
            } @else {
                <a
                    mat-icon-button
                    [class]="iconClass()"
                    [color]="color()"
                    [queryParams]="queryParams()"
                    [queryParamsHandling]="queryParamsHandling()"
                    [routerLink]="navigate()"
                    [fragment]="fragment()"
                    [preserveFragment]="preserveFragment()"
                    [disabled]="disabled()"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                </a>
            }
        }
        <!-- Click -->
        @case ('click') {
            @if (label()) {
                <a
                    [matButton]="appearance()"
                    [color]="color()"
                    [disabled]="disabled()"
                    (click)="buttonClick$.next($event)"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                    <span>{{ label() }}</span>
                </a>
            } @else {
                <a
                    mat-icon-button
                    [class]="iconClass()"
                    [color]="color()"
                    [disabled]="disabled()"
                    (click)="buttonClick$.next($event)"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                </a>
            }
        }
        <!-- External link -->
        @case ('href') {
            @if (label()) {
                <a
                    target="_blank"
                    [matButton]="appearance()"
                    [attr.href]="href()"
                    [color]="color()"
                    [disabled]="disabled()"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                    <span>{{ label() }}</span>
                </a>
            } @else {
                <a
                    mat-icon-button
                    target="_blank"
                    [class]="iconClass()"
                    [attr.href]="href()"
                    [color]="color()"
                    [disabled]="disabled()"
                >
                    @if (theIcon) {
                        <mat-icon [naturalIcon]="theIcon" />
                    }
                </a>
            }
        }
    }
}
